<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é«˜çŸ¥ï½œæ­´å²ãƒ»ç½å®³ãƒ»äººç‰©ãƒãƒƒãƒ—</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body { margin:0; font-family:sans-serif; background:#f5f5f5; }

#header {
  padding:14px 12px 10px;
  background:linear-gradient(135deg, #0d47a1, #1976d2);
  color:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,0.3);
}
.main-title { font-size:20px; font-weight:800; }
.subtitle { font-size:12px; opacity:0.9; margin-top:4px; }

#legend, #filters {
  display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;
}
.legend-item, .filter-btn {
  display:flex; align-items:center; gap:6px;
  background:#fff; color:#1976d2;
  padding:4px 10px; border-radius:999px;
  font-size:11px; font-weight:600; cursor:pointer; border:none;
}
.legend-item.active, .filter-btn.active {
  background:#000; color:#fff;
}
.legend-color {
  width:10px; height:10px; border-radius:50%;
}

#map { height:50vh; }

#timeline {
  height:40vh; display:flex; gap:12px; padding:12px;
  overflow-x:auto; background:#fff;
  border-top-left-radius:16px;
  border-top-right-radius:16px;
}

.event {
  min-width:220px; border-radius:12px; padding:10px;
  cursor:pointer; box-shadow:0 2px 5px rgba(0,0,0,0.2);
  flex-shrink:0; color:#fff;
}
.event.active { outline:3px solid #000; }
.year { font-weight:bold; font-size:14px; }
.title { font-size:13px; margin:4px 0; }
.person-name { font-size:12px; margin-top:6px; }
</style>
</head>

<body>

<div id="header">
  <div class="main-title">é«˜çŸ¥ï½œæ­´å²ãƒ»ç½å®³ãƒ»äººç‰©ãƒãƒƒãƒ—</div>
  <div class="subtitle">ğŸ“… å¹´è¡¨ Ã— ğŸ—º åœ°å›³ã§é«˜çŸ¥ã®å‡ºæ¥äº‹ã‚’ãŸã©ã‚‹</div>

  <div id="legend">
    <div class="legend-item active" data-cat="all">
      <span class="legend-color" style="background:#000;"></span> ã™ã¹ã¦
    </div>
    <div class="legend-item" data-cat="history">
      <span class="legend-color" style="background:#1976d2;"></span> æ­´å²
    </div>
    <div class="legend-item" data-cat="disaster">
      <span class="legend-color" style="background:#d32f2f;"></span> ç½å®³
    </div>
    <div class="legend-item" data-cat="person">
      <span class="legend-color" style="background:#388e3c;"></span> äººç‰©
    </div>
  </div>

  <div id="filters">
    <button class="filter-btn active" data-era="all">ã™ã¹ã¦</button>
    <button class="filter-btn" data-era="medieval">æˆ¦å›½ã€œä¸­ä¸–</button>
    <button class="filter-btn" data-era="edo">æ±Ÿæˆ¸</button>
    <button class="filter-btn" data-era="modern">è¿‘ä»£</button>
    <button class="filter-btn" data-era="contemporary">ç¾ä»£</button>
  </div>
</div>

<div id="map"></div>
<div id="timeline"></div>

<script>
const map = L.map("map").setView([33.5597,133.5311],9);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { attribution:"Â© OpenStreetMap" }).addTo(map);
let markers = [];

const categoryColor = { history:"#1976d2", disaster:"#d32f2f", person:"#388e3c" };

const events = [
  { era:"medieval", category:"history", year:"12ä¸–ç´€æœ«", title:"é•·å®—æˆ‘éƒ¨æ°ã®å°é ­",
    detail:"åœŸä½å›½ã®åœ¨åœ°å‹¢åŠ›ã¨ã—ã¦é•·å®—æˆ‘éƒ¨æ°ãŒå°é ­ã—ã€å¾Œã®åœŸä½çµ±ä¸€ã®åŸºç›¤ãŒå½¢ã¥ãã‚‰ã‚ŒãŸã€‚",
    people:["é•·å®—æˆ‘éƒ¨æ°"], spot:{ lat:33.5660, lng:133.6020, text:"å²¡è±ŠåŸï¼ˆå—å›½å¸‚ï¼‰" } },

  { era:"medieval", category:"history", year:"1575å¹´", title:"é•·å®—æˆ‘éƒ¨å…ƒè¦ªã€åœŸä½çµ±ä¸€",
    detail:"é•·å®—æˆ‘éƒ¨å…ƒè¦ªãŒåœŸä½å›½å†…ã®è«¸å‹¢åŠ›ã‚’åˆ¶åœ§ã—ã€æˆ¦å›½å¤§åã¨ã—ã¦ã®æ”¯é…ä½“åˆ¶ã‚’ç¢ºç«‹ã—ãŸã€‚",
    people:["é•·å®—æˆ‘éƒ¨å…ƒè¦ª"], spot:{ lat:33.5660, lng:133.6020, text:"å²¡è±ŠåŸè·¡" } },

  { era:"edo", category:"history", year:"1601å¹´", title:"å±±å†…ä¸€è±Š å…¥å›½",
    detail:"é–¢ãƒ¶åŸã®æˆ¦ã„ã®åŠŸç¸¾ã«ã‚ˆã‚ŠåœŸä½ä¸€å›½ã‚’æ‹é ˜ã€‚é«˜çŸ¥åŸã®ç¯‰åŸã¨åŸä¸‹ç”ºæ•´å‚™ãŒé€²ã‚“ã ã€‚",
    people:["å±±å†…ä¸€è±Š"], spot:{ lat:33.5606, lng:133.5353, text:"é«˜çŸ¥åŸ" } },

  { era:"edo", category:"disaster", year:"1707å¹´", title:"å®æ°¸åœ°éœ‡ãƒ»æ´¥æ³¢",
    detail:"å—æµ·ãƒˆãƒ©ãƒ•å·¨å¤§åœ°éœ‡ã®ä¸€ã¤ã€‚æ²¿å²¸éƒ¨ã‚’ä¸­å¿ƒã«å¤§ããªè¢«å®³ãŒå‡ºãŸã€‚",
    people:["è¨˜éŒ²ã‚’æ®‹ã—ãŸåƒ§"], spot:{ lat:33.2770, lng:134.1813, text:"å®¤æˆ¸æ²¿å²¸éƒ¨" } },

  { era:"modern", category:"person", year:"1827å¹´", title:"ã‚¸ãƒ§ãƒ³ä¸‡æ¬¡éƒ èª•ç”Ÿ",
    detail:"æ¼‚æµã‚’ãã£ã‹ã‘ã«æ¸¡ç±³ã—ã€è¥¿æ´‹ã®çŸ¥è­˜ã‚„æ–‡åŒ–ã‚’æ—¥æœ¬ã«ã‚‚ãŸã‚‰ã—ãŸã€‚",
    people:["ã‚¸ãƒ§ãƒ³ä¸‡æ¬¡éƒ"], spot:{ lat:32.9710, lng:133.0290, text:"åœŸä½æ¸…æ°´å¸‚" } },

  { era:"modern", category:"person", year:"1836å¹´", title:"å‚æœ¬é¾é¦¬ èª•ç”Ÿ",
    detail:"è–©é•·åŒç›Ÿã®ä»²ä»‹ãªã©ã‚’è¡Œã„ã€æ˜æ²»ç¶­æ–°ã®æµã‚Œã‚’ã¤ãã£ãŸã€‚",
    people:["å‚æœ¬é¾é¦¬"], spot:{ lat:33.5527, lng:133.5314, text:"é«˜çŸ¥å¸‚" } },

  { era:"modern", category:"person", year:"1837å¹´", title:"æ¿å£é€€åŠ© èª•ç”Ÿ",
    detail:"è‡ªç”±æ°‘æ¨©é‹å‹•ã‚’ä¸»å°ã—ã€æ—¥æœ¬ã®è­°ä¼šæ”¿æ²»ã®ç¤ã‚’ç¯‰ã„ãŸã€‚",
    people:["æ¿å£é€€åŠ©"], spot:{ lat:33.5650, lng:133.6040, text:"å—å›½å¸‚" } },

  { era:"contemporary", category:"disaster", year:"1946å¹´", title:"æ˜­å’Œå—æµ·åœ°éœ‡",
    detail:"æ´¥æ³¢ã«ã‚ˆã‚Šæ²¿å²¸éƒ¨ã§è¢«å®³ã€‚æˆ¦å¾Œå¾©èˆˆã¨é‡ãªã‚Šå¤§ããªå›°é›£ã¨ãªã£ãŸã€‚",
    people:["é«˜çŸ¥çœŒæ°‘"], spot:{ lat:33.7350, lng:133.8950, text:"å®‰èŠ¸å¸‚å‘¨è¾º" } },

  { era:"contemporary", category:"disaster", year:"1975å¹´", title:"é«˜çŸ¥å¤§æ°´å®³",
    detail:"å››ä¸‡åå·æµåŸŸã‚’ä¸­å¿ƒã«åºƒç¯„å›²ã§æµ¸æ°´è¢«å®³ãŒç™ºç”Ÿã—ãŸã€‚",
    people:["åœ°åŸŸä½æ°‘"], spot:{ lat:33.2750, lng:132.8667, text:"å››ä¸‡åå·æµåŸŸ" } },

  { era:"contemporary", category:"disaster", year:"1998å¹´", title:"é«˜çŸ¥è±ªé›¨ç½å®³",
    detail:"é›†ä¸­è±ªé›¨ã«ã‚ˆã‚ŠåœŸç ‚ç½å®³ã‚„æ²³å·æ°¾æ¿«ãŒç™ºç”Ÿã—ãŸã€‚",
    people:["åœ°åŸŸä½æ°‘"], spot:{ lat:33.5597, lng:133.5311, text:"é«˜çŸ¥å¸‚å‘¨è¾º" } },

  { era:"contemporary", category:"disaster", year:"2011å¹´", title:"é˜²ç½æ„è­˜ã®é«˜ã¾ã‚Š",
    detail:"æ±æ—¥æœ¬å¤§éœ‡ç½ã‚’å—ã‘ã€å—æµ·ãƒˆãƒ©ãƒ•åœ°éœ‡ã¸ã®å‚™ãˆãŒå¼·åŒ–ã•ã‚ŒãŸã€‚",
    people:["é«˜çŸ¥çœŒæ°‘"], spot:{ lat:33.5597, lng:133.5311, text:"çœŒå†…å„åœ°" } }
];

const timeline = document.getElementById("timeline");
let currentEra = "all";
let currentCat = "all";

function clearMarkers(){
  markers.forEach(m => map.removeLayer(m));
  markers = [];
}

function showEvent(list, index){
  clearMarkers();
  document.querySelectorAll(".event").forEach(e=>e.classList.remove("active"));
  document.querySelectorAll(".event")[index].classList.add("active");

  const e = list[index];
  map.setView([e.spot.lat, e.spot.lng], 11, { animate:true, duration:0.5 });

  const color = categoryColor[e.category] || "#1976d2";
  const marker = L.circleMarker([e.spot.lat, e.spot.lng], {
    radius:10, color:color, fillColor:color, fillOpacity:0.9
  }).addTo(map);

  marker.bindPopup(`
    <strong>${e.year} ${e.title}</strong><br>
    <small>${e.spot.text}</small>
    <p style="font-size:12px; line-height:1.5; margin:6px 0;">${e.detail}</p>
    <hr>
    ${e.people.map(p=>`<div>ğŸ‘¤ ${p}</div>`).join("")}
  `).openPopup();

  markers.push(marker);
}

function renderTimeline(){
  timeline.innerHTML="";
  clearMarkers();

  let filtered = events.filter(e =>
    (currentEra==="all" || e.era===currentEra) &&
    (currentCat==="all" || e.category===currentCat)
  );

  filtered.forEach((e,i)=>{
    const div = document.createElement("div");
    div.className="event";
    div.style.background = categoryColor[e.category];
    div.innerHTML = `
      <div class="year">${e.year}</div>
      <div class="title">${e.title}</div>
      ${e.people.map(p=>`<div class="person-name">ğŸ‘¤ ${p}</div>`).join("")}
    `;
    div.onclick = ()=>showEvent(filtered, i);
    timeline.appendChild(div);
  });

  if(filtered.length) showEvent(filtered,0);
}

document.querySelectorAll(".filter-btn").forEach(btn=>{
  btn.onclick = ()=>{
    document.querySelectorAll(".filter-btn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    currentEra = btn.dataset.era;
    renderTimeline();
  };
});

document.querySelectorAll(".legend-item").forEach(item=>{
  item.onclick = ()=>{
    document.querySelectorAll(".legend-item").forEach(i=>i.classList.remove("active"));
    item.classList.add("active");
    currentCat = item.dataset.cat;
    renderTimeline();
  };
});

renderTimeline();
</script>

</body>
</html>
