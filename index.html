<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é«˜çŸ¥ï½œæ­´å²ãƒ»ç½å®³ãƒ»äººç‰©ãƒãƒƒãƒ—</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
body { margin:0; font-family:sans-serif; background:#f5f5f5; }
#header { padding:10px; background:#263238; color:#fff; font-size:14px; }
#header span { display:block; font-size:12px; opacity:0.9; }
#map { height:50vh; }
#timeline { height:40vh; display:flex; gap:12px; padding:12px; overflow-x:auto; }
.event { min-width:220px; border-radius:12px; padding:10px; cursor:pointer; box-shadow:0 2px 5px rgba(0,0,0,0.2); flex-shrink:0; color:#fff; }
.event.active { outline:3px solid #000; }
.year { font-weight:bold; font-size:14px; }
.title { font-size:13px; margin:4px 0; }
.person { display:flex; align-items:center; gap:8px; margin-top:6px; }
.person img { width:40px; height:40px; border-radius:50%; object-fit:cover; cursor:pointer; border:2px solid #fff; }
.person-name { font-size:12px; color:#fff; }
</style>
</head>

<body>

<div id="header">
  ğŸ“… å¹´è¡¨ã§ã€Œã„ã¤ãƒ»ä½•ãŒèµ·ããŸã‹ã€
  <span>ğŸ–¼ å†™çœŸã§ã€Œèª°ãŒé–¢ã‚ã£ãŸã‹ã€ / ğŸ—º åœ°å›³ã§ã€Œã©ã“ã§èµ·ããŸã‹ã€</span>
</div>

<div id="map"></div>
<div id="timeline"></div>

<script>
const map = L.map("map").setView([33.5597,133.5311],9);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { attribution:"Â© OpenStreetMap" }).addTo(map);

let markers = [];

const categoryColor = {
  history:"#1976d2", // é’
  disaster:"#d32f2f", // èµ¤
  person:"#388e3c" // ç·‘
};

// é«˜çŸ¥çœŒå…¨åŸŸã‚¤ãƒ™ãƒ³ãƒˆã‚µãƒ³ãƒ—ãƒ«
const events = [
  // é«˜çŸ¥å¸‚
  { year:"1601å¹´", title:"å±±å†…ä¸€è±Š å…¥å›½", category:"history",
    people:[{ name:"å±±å†…ä¸€è±Š", img:"https://upload.wikimedia.org/wikipedia/commons/1/1f/Yamauchi_Kazutoyo.jpg", desc:"åœŸä½è—©åˆä»£è—©ä¸»" }],
    spot:{ lat:33.5606, lng:133.5353, text:"é«˜çŸ¥åŸç¯‰åŸ" } 
  },
  { year:"1836å¹´", title:"å‚æœ¬é¾é¦¬ èª•ç”Ÿ", category:"person",
    people:[{ name:"å‚æœ¬é¾é¦¬", img:"https://upload.wikimedia.org/wikipedia/commons/7/7e/Sakamoto_Ryoma.jpg", desc:"å¹•æœ«ã®å¿—å£«" }],
    spot:{ lat:33.5527, lng:133.5314, text:"å‚æœ¬é¾é¦¬èª•ç”Ÿåœ°" } 
  },
  // å—å›½å¸‚
  { year:"1837å¹´", title:"æ¿å£é€€åŠ© èª•ç”Ÿ", category:"person",
    people:[{ name:"æ¿å£é€€åŠ©", img:"https://upload.wikimedia.org/wikipedia/commons/9/97/I_ta_gaki_Taisuke2.jpg", desc:"è‡ªç”±æ°‘æ¨©é‹å‹•ã®æŒ‡å°è€…" }],
    spot:{ lat:33.5650, lng:133.6040, text:"å—å›½å¸‚ã®é«˜çŸ¥åŸä¸‹ä»˜è¿‘ã§èª•ç”Ÿ" } 
  },
  // åœŸä½æ¸…æ°´å¸‚
  { year:"1827å¹´", title:"ã‚¸ãƒ§ãƒ³ä¸‡æ¬¡éƒï¼ˆä¸­æµœä¸‡æ¬¡éƒï¼‰ èª•ç”Ÿ", category:"person",
    people:[{ name:"ã‚¸ãƒ§ãƒ³ä¸‡æ¬¡éƒ", img:"https://upload.wikimedia.org/wikipedia/commons/2/25/John_Manjiro.jpg", desc:"å¹•æœ«ã®èˆªæµ·è€…ãƒ»é€šè¨³ãƒ»æ—¥æœ¬ã®æµ·å¤–äº¤æµã®å…ˆé§†è€…" }],
    spot:{ lat:32.9710, lng:133.0290, text:"åœŸä½æ¸…æ°´å¸‚ã§èª•ç”Ÿ" } 
  },
  // å®¤æˆ¸å¸‚
  { year:"1707å¹´", title:"å®æ°¸åœ°éœ‡ãƒ»æ´¥æ³¢", category:"disaster",
    people:[{ name:"åƒ§ãƒ»å¦‚æ³•", img:"https://upload.wikimedia.org/wikipedia/commons/8/89/Buddhist_monk.png", desc:"æ´¥æ³¢ã®è¢«å®³ã‚’è¨˜éŒ²ã—ãŸåƒ§" }],
    spot:{ lat:33.2770, lng:134.1813, text:"å®¤æˆ¸æ²¿å²¸éƒ¨ã«è¢«å®³" } 
  },
  // å®‰èŠ¸å¸‚
  { year:"1946å¹´", title:"æ˜­å’Œå—æµ·åœ°éœ‡", category:"disaster",
    people:[{ name:"é«˜çŸ¥çœŒæ°‘", img:"https://upload.wikimedia.org/wikipedia/commons/6/6f/People_icon.svg", desc:"å¾©èˆˆã«å°½åŠ›ã—ãŸäººã€…" }],
    spot:{ lat:33.7350, lng:133.8950, text:"å®‰èŠ¸å¸‚å‘¨è¾ºã§æ´¥æ³¢è¢«å®³" } 
  },
  // å››ä¸‡åå¸‚
  { year:"1975å¹´", title:"é«˜çŸ¥å¤§æ°´å®³", category:"disaster",
    people:[{ name:"åœ°åŸŸä½æ°‘", img:"https://upload.wikimedia.org/wikipedia/commons/6/6f/People_icon.svg", desc:"ä½å®…åœ°æµ¸æ°´å¯¾å¿œ" }],
    spot:{ lat:33.2750, lng:132.8667, text:"å››ä¸‡åå·æµåŸŸã§æ°´å®³" } 
  }
];

const timeline = document.getElementById("timeline");

function clearMarkers(){
  markers.forEach(m => map.removeLayer(m));
  markers = [];
}

function showPersonDetail(person){
  const popup = L.popup()
    .setLatLng(map.getCenter())
    .setContent(`
      <div style="text-align:center">
        <img src="${person.img}" style="width:150px; border-radius:10px;"><br>
        <b>${person.name}</b><br>
        <p>${person.desc}</p>
      </div>
    `)
    .openOn(map);
}

function showEvent(index){
  clearMarkers();
  document.querySelectorAll(".event").forEach(e=>e.classList.remove("active"));
  document.querySelectorAll(".event")[index].classList.add("active");

  const e = events[index];
  const color = categoryColor[e.category] || "#1976d2";

  const marker = L.circleMarker([e.spot.lat, e.spot.lng], {
    radius:10,
    color:color,
    fillColor:color,
    fillOpacity:0.9
  }).addTo(map);

  marker.bindPopup(`
    <strong>${e.year} ${e.title}</strong><br>
    ${e.spot.text}<hr>
    ${e.people.map((p,i)=>`
      <div class="person-popup" style="margin-top:5px">
        <img src="${p.img}" width="50" style="border-radius:8px; cursor:pointer;" data-index="${i}"><br>
        <b>${p.name}</b><br>
        <small>${p.desc}</small>
      </div>
    `).join("")}
  `).openPopup();

  marker.on("popupopen", ()=>{
    const imgs = document.querySelectorAll(".person-popup img");
    imgs.forEach((img, i)=>{
      img.onclick = ()=>showPersonDetail(e.people[i]);
    });
  });

  markers.push(marker);
}

// ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä½œæˆï¼ˆè‰²åˆ†ã‘ï¼‰
events.forEach((e,i)=>{
  const div = document.createElement("div");
  div.className="event";
  div.style.background = categoryColor[e.category] || "#1976d2";
  div.innerHTML=`
    <div class="year">${e.year}</div>
    <div class="title">${e.title}</div>
    ${e.people.map((p,idx)=>`
      <div class="person">
        <img src="${p.img}" data-index="${idx}">
        <div class="person-name">${p.name}</div>
      </div>
    `).join("")}
  `;
  timeline.appendChild(div);

  div.onclick = ()=>showEvent(i);

  const imgs = div.querySelectorAll("img");
  imgs.forEach((img, idx)=>{
    img.onclick = (ev)=>{
      ev.stopPropagation();
      showPersonDetail(e.people[idx]);
    };
  });
});

showEvent(0);
</script>

</body>
</html>

